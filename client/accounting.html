<head>
  <title>accounting</title>
	<style>
		th, td {border: 1px black solid}
		table {border-collapse: collapse}
	</style>
</head>

<body>
	{{> loginButtons}}
	{{#if currentUser}}
		<div>
			<label>Select Project: <input id="projects"></label>
		</div>
		{{#if currentProject}}
			<div>
				<button id="transactionsPage">Transactions</button>
				<button id="reportsPage">Reports</button>
			</div>
			<hr>
			{{#if currentPageIsTransactions}}
		    {{> transactions}}
		  {{/if}}
		  {{#if currentPageIsReports}}
				{{> reports}}
			{{/if}}
		{{/if}}
	{{else}}
		<h1>Welcome to Simple Multi-Currency Accounting System SMCAS!</h1>
		<p>You need to login to have access to you transctions!!!!!!!!!!!!!!!!</p>
	{{/if}}
</body>



<template name="reports">
	<div>
		Per account report:
		<br>
		{{#each accounts}}
			{{account}}<br>
			{{#each months}}
					&nbsp;&nbsp;{{year}}, {{month}}<br>
				{{#each categories}}
						&nbsp;&nbsp;&nbsp;&nbsp;{{category}}: {{sumAmount}}<br>
				{{/each}}
			{{/each}}
			<br>
			Total Balance: {{totalBalance}}
			<br><br><br>
		{{/each}}
	</div>
</template>

<template name="transactions">
	<div>
		<div>
			<label>Dollar to TL multiply: <input id="dollarToTl" name="dollarToTl" type="number" min="0" value="2.586"></label>
			<label>Dollar to Euro multiply: <input id="dollarToEuro" name="dollarToEuro" type="number" min="0" value="0.91"></label>
		</div>
		<hr>
		<div>
		  <form class="addTransaction">
			  <div><label>From Account: <input id="fromAccount" name="fromAccount" value="{{defaultFromAccount}}"></label></div>
			  <div><label>To Account<input id="toAccount" name="toAccount" value="{{defaultToAccount}}"></label></div>
			  <div><label>Category: <input id="category" name="category" value="{{defaultCategory}}"></label></div>
			  <div><label>Amount in Dollar: <input type="number" step="0.01" min="0" name="dollarAmount" value="{{defaultDollarAmount}}"></label></div>
			  <div><label>Amount in TL: <input type="number" step="0.01" min="0" name="tlAmount" value="{{defaultTlAmount}}"></label></div>
			  <div><label>Amount in Euro: <input type="number" step="0.01" min="0" name="euroAmount" value="{{defaultEuroAmount}}"></label></div>
			  <div><label>Date: <input type="text" size="10" pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))" required name="date" value="{{formatDate defaultDate}}"></label></div>
			  <div><label>Invoice link: <input type="url" name="invoiceLink" value="{{defaultInvoiceLink}}"></label></div>
			  <div><label>Description: <textarea name="description">{{defaultDescription}}</textarea></label></div>
			  <div><label>Note: <textarea name="note">{{defaultNote}}</textarea></label></div>
			  <div><input type="submit"><input type="reset" class="reset"></div>
		  </form>
		</div>
		<hr>
		<table>
			<thead>
				<tr>
					<th>Id</th>
					<th>From Account</th>
					<th>To Account</th>
					<th>Amount</th>
					<th>Dollar</th>
					<th>TL</th>
					<th>Euro</th>
					<th>Date</th>
					<th>Category</th>
					<th>Invoice</th>
					<th>Description</th>
					<th>Note</th>
					<th>Created At</th>
					<th>X</th>
				</tr>
			</thead>
			<tbody>
		  {{#each transactions}}
					<tr>
						<td><a href="#" class="transactionId">{{_id}}</a></td>
						<td>{{fromAccount}}</td>
						<td>{{toAccount}}</td>
						<td>{{amount}}</td>
						<td>{{dollarAmount}}</td>
						<td>{{tlAmount}}<br><small>{{tlRatio}}</small></td>
						<td>{{euroAmount}}<br><small>{{euroRatio}}</small></td>
						<td>{{formatDate date}}</td>
						<td>{{category}}</td>
						<td>{{invoiceLink}}</td>
						<td>{{description}}</td>
						<td>{{note}}</td>
						<td>{{createdAt}}</td>
						<td><a href="#" class="deleteTransaction">X</a></td>
					</tr>
		  {{/each}}
			</tbody>
		</table>
	</div>
</template>
